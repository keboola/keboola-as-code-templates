CREATE TABLE `COMPANIES` (
  `ID` STRING(2000),
  `INDUSTRY` STRING(255),
  `CITY` STRING(255),
  `NUMBEROFEMPLOYEES` INT64,
  `HS_NUM_OPEN_DEALS` INT64,
  `STATE` STRING(255),
  `NAME` STRING(255),
  `TOTAL_REVENUE` NUMERIC(38, 0),
  `CREATED_AT` STRING(255),
  `ARCHIVED` BOOL,
  `COUNTRY` STRING(255),
  `CREATEDATE` STRING(255),
  `HS_ANALYTICS_SOURCE` STRING(255),
  `ZIP` STRING(255),
  `WEBSITE` STRING(255),
  `CREATED_AT_DATE` DATE,
  `CREATED_AT_TIME` TIME,
  `HS_IS_TARGET_ACCOUNT` STRING(255),
  `UPDATED_AT` STRING(255),
  `HS_ANALYTICS_LAST_VISIT_DATE` DATE,
  `HS_ANALYTICS_NUM_VISITS` NUMERIC(38, 0),
  `LIFECYCLESTAGE` STRING(255)
);

INSERT INTO `COMPANIES`
SELECT
  `ID`,
  `INDUSTRY`,
  `CITY`,
  `NUMBEROFEMPLOYEES`,
  `HS_NUM_OPEN_DEALS`,
  `STATE`,
  `NAME`,
  `TOTAL_REVENUE`,
  `CREATED_AT`,
  `ARCHIVED`,
  `COUNTRY`,
  `CREATEDATE`,
  `HS_ANALYTICS_SOURCE`,
  `ZIP`,
  `WEBSITE`,
  CAST(`CREATEDATE` AS DATE) AS `CREATED_AT_DATE`,
  TIME(`CREATEDATE`) AS `CREATED_AT_TIME`,
  `HS_IS_TARGET_ACCOUNT`,
  CAST(NULLIF(`UPDATED_AT`, '') AS DATE) AS `UPDATED_AT`,
  CAST(NULLIF(`HS_ANALYTICS_LAST_VISIT_TIMESTAMP`, '') AS DATE) AS `HS_ANALYTICS_LAST_VISIT_DATE`,
  `HS_ANALYTICS_NUM_VISITS`,
  COALESCE(`LIFECYCLESTAGE`, 'Subscriber') AS `LIFECYCLESTAGE`
FROM `HS_COMPANIES`;